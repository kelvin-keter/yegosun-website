{% extends "base.html" %}
{% block title %}Solar Savings Calculator{% endblock %}

{% block content %}
<div class="bg-dark text-white py-5 position-relative" style="background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?q=80&w=1600&auto=format&fit=crop'); background-size: cover; background-position: center;">
    <div class="container text-center position-relative" style="z-index: 2;">
        <h6 class="text-warning fw-bold text-uppercase tracking-wide mb-3">Free Energy Audit</h6>
        <h1 class="display-4 fw-extrabold">Calculate Your Savings</h1>
        <p class="lead text-white-50">Get a customized engineering report sent to your inbox in seconds.</p>
    </div>
</div>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-7">
            <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                <div class="card-header bg-white p-4 border-bottom">
                    <h5 class="mb-0 fw-bold text-dark"><i class="fa-solid fa-calculator me-2 text-success"></i> Solar Estimator</h5>
                </div>
                <div class="card-body p-5">
                    
                    <form action="/generate_report" method="POST" id="solarForm">
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold text-muted small text-uppercase">1. Average Monthly Bill</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-light border-0 fw-bold">KES</span>
                                <input type="number" name="monthly_bill" id="monthlyBill" class="form-control bg-light border-0 fw-bold" placeholder="e.g. 5000" required>
                            </div>
                        </div>

                        <div class="mb-5">
                            <label class="form-label fw-bold text-muted small text-uppercase mb-3">2. What heavy appliances do you run?</label>
                            <div class="row g-3">
                                <div class="col-6">
                                    <div class="form-check p-3 border rounded bg-light hover-shadow">
                                        <input class="form-check-input" type="checkbox" name="appliances" value="Refrigerator" id="app1">
                                        <label class="form-check-label fw-medium cursor-pointer" for="app1">Refrigerator</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-check p-3 border rounded bg-light hover-shadow">
                                        <input class="form-check-input" type="checkbox" name="appliances" value="Instant Shower" id="app2">
                                        <label class="form-check-label fw-medium cursor-pointer" for="app2">Instant Shower</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-check p-3 border rounded bg-light hover-shadow">
                                        <input class="form-check-input" type="checkbox" name="appliances" value="Washing Machine" id="app3">
                                        <label class="form-check-label fw-medium cursor-pointer" for="app3">Washing Machine</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-check p-3 border rounded bg-light hover-shadow">
                                        <input class="form-check-input" type="checkbox" name="appliances" value="Water Pump" id="app4">
                                        <label class="form-check-label fw-medium cursor-pointer" for="app4">Water Pump</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="initialBtnContainer">
                            <button type="button" onclick="showLeadForm()" class="btn btn-warning w-100 btn-lg fw-bold shadow-sm py-3 text-uppercase">
                                Calculate My Savings <i class="fa-solid fa-arrow-right ms-2"></i>
                            </button>
                        </div>

                        <div id="leadCapture" class="mt-4 pt-4 border-top" style="display:none; animation: fadeIn 0.6s;">
                            
                            <div class="alert alert-success border-0 d-flex align-items-center mb-4 shadow-sm">
                                <div class="bg-success rounded-circle d-flex align-items-center justify-content-center text-white me-3" style="width: 40px; height: 40px;">
                                    <i class="fa-solid fa-check"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-0 text-success">Analysis Complete!</h6>
                                    <p class="mb-0 small text-muted">We have calculated a solar plan for your <strong id="billDisplay"></strong> bill.</p>
                                </div>
                            </div>
                            
                            <h5 class="fw-bold mb-4 text-center">Where should we send your report?</h5>
                            
                            <div class="mb-3">
                                <div class="form-floating">
                                    <input type="text" name="full_name" class="form-control bg-light border-0" id="floatingName" placeholder="John Doe" required>
                                    <label for="floatingName">Full Name</label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <div class="form-floating">
                                    <input type="tel" name="phone" class="form-control bg-light border-0" id="floatingPhone" placeholder="07xx" required>
                                    <label for="floatingPhone">Phone Number</label>
                                </div>
                            </div>
                            <div class="mb-4">
                                <div class="form-floating">
                                    <input type="email" name="email" class="form-control bg-light border-0" id="floatingEmail" placeholder="name@example.com" required>
                                    <label for="floatingEmail">Email Address</label>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-dark w-100 btn-lg fw-bold shadow-lg py-3">
                                <i class="fa-solid fa-file-pdf me-2 text-danger"></i> Download My Report
                            </button>
                            <p class="text-center text-muted small mt-3 mb-0">
                                <i class="fa-solid fa-lock me-1"></i> Your data is secure. No spam, ever.
                            </p>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function showLeadForm() {
        var bill = document.getElementById('monthlyBill').value;
        if (bill && bill > 0) {
            // Hide the first button
            document.getElementById('initialBtnContainer').style.display = 'none';
            
            // Show the form
            var formDiv = document.getElementById('leadCapture');
            formDiv.style.display = 'block';
            
            // Update the text
            document.getElementById('billDisplay').innerText = "KES " + Number(bill).toLocaleString();
            
            // Smooth scroll to the form
            formDiv.scrollIntoView({behavior: "smooth"});
        } else {
            alert("Please enter a valid monthly bill amount to continue.");
        }
    }
</script>

<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .hover-shadow:hover { box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: 0.2s; }
    .form-check-input:checked { background-color: #2E7D32; border-color: #2E7D32; }
    .cursor-pointer { cursor: pointer; }
</style>
{% endblock %}